openapi: 3.0.1
info:
  title: Web Scraper
  description: |+
    This API is used to extract content or specific HTML elements from web pages. Supports both HTML and Text output. The web scraper can be instructed to extract HTML elements that match the criteria given in the queryList HTTP request parameter, it can even do navigate down the html tree like get all p tag inside a div class "class":"class_name p"
  x-description2: |+
    Examples:
    
    To get article content, as text
    {"url":&lt;URL&gt;}
    
    Returns all element text matches the tag name:
    <i>{"url":&lt;URL&gt;, queryList:[{"title":<give_your_name_for_the block>,"findType":"find_all","tag":"h1"}]}</i><br/><br/>Few queryList Examples:
    
    Returns all Html matches the tag name:
    <i>queryList:[{"title":<give_your_name_for_the block>,"findType":"find_all","tag":"h1", "returnType":"html"}]</i>
    
    Returns all Image Links:
    <i>queryList:[{"title":<give_your_name_for_the block>,"findType":"find_all","tag":"img", "attribute":"src"}]</i>
    
    Returns all Links(URL's):
    <i>queryList:[{"title":<give_your_name_for_the block>,"findType":"find_all","tag":"a", "attribute":"href"}]</i>
    
    Returns all links/text/html/images matches the class name:
    <i>queryList:[{"findType":"find_all", "class":<class_name>,"tag":"a", "attribute":"href"}],{"findType":"find_all", "class":<class_name>, "tag":"a"},{"findType":"find_all", "class":<class_name>, "tag":"a", "returnType":"html"},{"findType":"find_all", "class":<class_name>, "tag":"img", "attribute":"src"}]</i>
    
    Using select in findType, either class/tag/id/nestedclassid is mandatory:
    <i>queryList:[{"findType":"select", "class_":<class_name>, "tag":<tag_name>}]
    queryList:[{"findType":"select", "class_":<class_name>}]
    queryList:[{"findType":"select", "tag":<tag_name>}]
    queryList:[{"findType":"select", "id":, "tag":<tag_name>}]
    queryList:[{"findType":"select", "id":}]
    queryList:[{"findType":"select", "tag":<tag_name>}]
    queryList:[{"findType":"select", "nestedclassid":<nested class/id/tags>}]
    queryList:[{"findType":"select", "nestedclassid":<nested class/id/tags>, "returnType":"html"}]
    queryList:[{"findType":"select", "nestedclassid":<nested class/id/tags>, "attribute":"href"}]</i>
    Example using nestedclassid:<pre>&lt;div&gt;<br>&nbsp;&nbsp;&nbsp;&lt;h1&gt;This is heading&lt;/h1>&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p class="strikeout"&gt;This is paragraph 1&lt;/h1>&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p class="strikeout"&gt;This is paragraph 2&lt;/h1>&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p class="strikeout"&gt;This is paragraph 3&lt;/h1>&gt;<br>&lt;/div&gt;<br>&lt;div id="div2" class="divclass2"&gt;<br>&nbsp;&nbsp;&nbsp;&lt;h1&gt;This is another heading 2&lt;/h1>&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p class="strikeout"&gt;This is paragraph 4&lt;/p&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p class="strikeout"&gt;This is paragraph 5&lt;/p&gt;<br>&nbsp;&nbsp;&nbsp;&lt;p class="strikeout"&gt;This is paragraph 6&lt;/p&gt;<br>&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;a href="<https://www.google.com"&gt;&lt;/a&gt;Google&lt;/li&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="class3"&gt;&lt;a href="<https://www.facebook.com"&gt;&lt;/a&gt;Facebook&lt;/li&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;a href="<https://www.twitter.com"&gt;&lt;/a&gt;Twitter&lt;/li&gt;<br>&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br>&lt;/div&gt;</pre><br>To get tags that match one or more class names<br/><i>&nbsp;&nbsp;&nbsp;"queryList":[{"findType":"select", "nestedclassid":"p.strikeout"}]</i>
    To get h1 tags that match one or more class names
    <i>&nbsp;&nbsp;&nbsp;"queryList":[{"findType":"select", "nestedclassid":"h1"}]</i>
    To get all p tags that matches element id
    <i>&nbsp;&nbsp;&nbsp;"queryList":[{"findType":"select", "nestedclassid":"div#div2 p"}]</i>
    To get all litags that matches the element id<br/><i>&nbsp;&nbsp;&nbsp;"queryList":[{"findType":"select", "nestedclassid":"div#div2 ul li"}]</i><br/>To get links from ul list
    <i>&nbsp;&nbsp;&nbsp;"queryList":[{"findType":"select", "nestedclassid":"ul li a"}]</i>
    To get links from ul list that matches one or more class names<br/><i>&nbsp;&nbsp;&nbsp;"queryList":[{"findType":"select", "nestedclassid":"ul li.class3 a"}]</i>
    To get links a element that matches the element id and class name<br/><i>&nbsp;&nbsp;&nbsp;"queryList":[{"findType":"select", "nestedclassid":"div#div2 ul li.class3 a"}]</i>
    
    <b>Notes:</b>
    title - is an optional parameter, if title is empty the return json key is "values"<br/>findType - find/find_all/select
    &nbsp;&nbsp;&nbsp;&bull;&nbsp;find - returns first matching possibility<br/>&nbsp;&nbsp;&nbsp;&bull;&nbsp;find_all - returns all matching possibilities
    &nbsp;&nbsp;&nbsp;&bull;&nbsp;select - If you want to search for tags that match two or more CSS classes. either class/tag/id/nestedclassid is mandatory
    **return type is not supported alone with attribute.
    
    The results are returned in JSON format and allow for developers to rapidly retrieve website elements like tables, images, etc. from URL
  version: '1.0'
servers:
  - url: 'https://apis.sentient.io'
tags:
- name: "v1.0"
  description: "Published Date - Feb 10, 2020"
paths:
  /microservices/utility/webscraping/v1.0/getresults:
    post:
      tags:
        - v1.0
      responses:
        '200':
          description: success response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/success'
              example:
                url: string
                queryList:
                - findType: string
                  tag: string
                  id: string
                  class: string
                  nestedclassid: string
                  attribute: string
                  title: string
                  returnType: string
        '400':
          description: Restricted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/restricted'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/unauthorized'
        '402':
          description: Payment Required
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/paymentrequired'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/forbidden'
        '404':
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/notfound'
        '419':
          description: Input Field Missing
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inputfieldmissing'
        '420':
          description: Input Limit Exceeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/inputlimitexceeded'       
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/servererror'
        '504':
          description: Gateway Timeout
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/gatewaytimeout'
      security:
        - APIAuthorizer: []
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/input'
        required: true
components:
  schemas:
    success:
      type: object
      properties:
        results:
          type: array
          items:
            properties:
              links:
                type: array
                items:
                  oneOf:
                    - type: string
                      example: https://www.bbc.co.uk
                    - type: string
                      example: https://www.bbc.co.uk/accessibility/
                    - type: string
                      example: https://www.bbc.co.uk/news
                    - type: string
                      example: https://www.bbc.co.uk/news
                    - type: string
                      example: https://www.bbc.co.uk/news
                    - type: string
                      example: https://www.bbc.co.uk/weather
              values:
                type: array
                items:
                  oneOf:
                    - type: object
                      properties:
                        value: 
                          type: string
                          example: <a href=\"https://www.bbc.co.uk\">Home</a>
                    - type: object
                      properties:
                        value: 
                          type: string
                          example: <a href=\"https://www.bbc.co.uk/news\">News</a>
                    - type: object
                      properties:
                        value:
                          type: string
                          example: <a href=\"https://www.bbc.co.uk/sport\">Sport</a>
              images:
                  type: array
                  items:
                    oneOf:
                      - type: string
                        example: https://ichef.bbci.co.uk/news/320/cpsprodpb/0DDC/production/_112984530_gettyimages-1227286994.jpg       
                      - type: string
                        example: https://ichef.bbci.co.uk/images/ic/720x405/p08dwhp8.jpg
        message:
          type: string
          example: successfully processed
          description: Detail description on the API status
        status:
          type: string
          example: success
          description: The status of the API call success/failure
    unauthorized:
      type: object
      properties:
        message:
          type: string
          example: Missing Authentication Token
        status:
          type: string
          example: Failure
    restricted:
      type: object
      properties:
        message:
          type: string
          example: The content is restricted
        status:
          type: string
          example: Failure
    forbidden:
      type: object
      properties:
        message:
          type: string
          example: Access Denied Unauthorized User
        status:
          type: string
          example: Failure
    paymentrequired:
      type: object
      properties:
        message:
          type: string
          example: Insufficient Credits Kindly Top Up
        status:
          type: string
          example: Failure
    notfound:
      type: object
      properties:
        message:
          type: string
          example: Invalid Request
        status:
          type: string
          example: Failure
    servererror:
      type: object
      properties:
        message:
          type: string
          example: Internal Server Error
        status:
          type: string
          example: Failure
    gatewaytimeout:
      type: object
      properties:
        message:
          type: string
          example: Request Timeout
        status:
          type: string
          example: Failure
    inputfieldmissing:
      type: object
      properties:
        message:
          type: string
          example: Input Field Missing
        status:
          type: string
          example: Failure
    inputlimitexceeded:
      type: object
      properties:
        message:
          type: string
          example: Input Limit Exceeded
        status:
          type: string
          example: Failure
    versions:
      type: object
      properties: 
        v0.1:
         type: array
         items:
          oneOf:
            - type: string
              example: Published Date - Feb 10, 2020
              description: Initial version release
    input:
      type: object
      properties:
        url:
          type: string
        queryList:
          type: array
          items:
            properties:
              findType:
                type: string
              tag:
                type: string
              id:
                type: string
              class:
                type: string
              nestedclassid:
                type: string
              attribute:
                type: string
              title:
                type: string
              returnType:
                type: string
  securitySchemes:
    APIAuthorizer:
      type: apiKey
      name: x-api-key
      in: header
      x-amazon-apigateway-authtype: custom
      description: Authentication is done using the x-api-key in the request header
